<section ng-controller="AlertHistoryController as AlertHistroyCtrl">
    <div class="row center-align flow-text">
        <h1 class="header-no-margin">Alert History</h1>
    </div>

    <div class="col s12">
        <div class="card blue-grey darken-3">
            <div class="card-content">
                <div class="row row-no-margin filters">
                    <div class="col s12 m8 l4 center-align no-padding">
                        <button
                            ng-repeat="server in config.serversAlpha"
                            ng-class="filters.servers.indexOf(server) == -1 ? 'btn-inactive' : ''"
                            class="btn waves-effect waves-light"
                            ng-click="toggleFilters('servers', server)">
                                {{::config.serverNames[server]}}
                        </button>
                        <p class="caption center-align">Servers</p>
                    </div>
                    <div class="col s12 m4 l3 center-align no-padding">
                        <button
                            ng-repeat="zone in config.zonesAlpha"
                            ng-class="filters.zones.indexOf(zone) == -1 ? 'btn-inactive' : ''"
                            class="btn waves-effect waves-light"
                            ng-click="toggleFilters('zones', zone)">
                                {{::config.zoneNames[zone]}}
                        </button>
                        <p class="caption center-align">Zones</p>
                    </div>
                    <div class="col s12 m4 l3 center-align no-padding">
                        <button
                            ng-repeat="faction in config.factions"
                            ng-class="filters.factions.indexOf(faction) == -1 ? 'btn-inactive' : '{{faction}}-back'"
                            class="btn waves-effect waves-light"
                            ng-click="toggleFilters('factions', faction)">
                                {{faction|uppercase}}
                        </button>
                        <p class="caption center-align">Factions</p>
                    </div>
                    <div class="col s12 m8 l2 center-align no-padding">
                        <button
                            ng-repeat="(bracket, info) in config.timeBrackets"
                            ng-class="filters.brackets.indexOf(bracket) == -1 ? 'btn-inactive' : ''"
                            ng-click="toggleFilters('brackets', bracket)"
                            class="btn waves-effect waves-light tooltipped"
                            data-tooltip="{{info.desc}}"
                            data-position="top">
                                {{info.label}}
                        </button>
                        <p class="caption center-align" ng-init="setTooltips()">Time Brackets</p>
                    </div>
                    <div class="col s12 center-align apply-btns">
                        <button
                            ng-click="applyFilter()"
                            ng-show="!data.inProgress"
                            class="btn btn-apply waves-effect waves-light">
                            <i class="fa fa-filter"></i> Filter
                        </button>
                        <button
                            ng-show="data.inProgress"
                            class="btn disabled btn-apply waves-effect waves-light">
                            <i class="fa fa-spin fa-refresh"></i> Loading...
                        </button>
                        <button
                            ng-click="showAll()"
                            class="btn waves-effect waves-light">
                            <i class="fa fa-eye"></i> Show All
                        </button>
                        <button
                            ng-click="clearFilter()"
                            class="btn btn-inactive waves-effect waves-light">
                            <i class="fa fa-eye-slash"></i> Hide All
                        </button>
                        <p class="caption">
                            If no selections are made for a group of filters, the filter will be ignored.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row row-no-margin" id="history-list">
        <div class="col s12">
            <div class="row center-align flow-text">
                <h6 ng-hide="!data.history.length">Showing {{data.history.length}} Results - Last 48 hours (temporary)</h6>
            </div>
            <div class="sk-three-bounce" ng-show="!data.history.length && !data.empty">
                <div class="sk-child sk-bounce1"></div>
                <div class="sk-child sk-bounce2"></div>
                <div class="sk-child sk-bounce3"></div>
                <p class="caption center-align">
                    Loading
                </p>
            </div>

            <div class="center-align flow-text center-align" ng-show="data.empty">
                <h3>
                    No results
                </h3>
                <p class="caption">
                    No alerts were found with your selected filters
                </p>
            </div>
            <div ng-repeat="(key, alert) in data.history"
                history-row
                metrics="alert"
                config="config">
            </div>
        </div>
    </div>
</section>
